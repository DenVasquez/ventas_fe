import{C as d}from"./index-0c1afda6.js";let a={materiales:[{id:1,cod:"MAT-001",name:"Madera de pino",unit_cost:25.75,stock:150,stock_minimo:500},{id:2,cod:"MAT-002",name:"Tornillos",unit_cost:.5,stock:500,stock_minimo:10},{id:3,cod:"MAT-003",name:"Pegamento",unit_cost:15.25,stock:3,stock_minimo:5},{id:4,cod:"MAT-004",name:"Pintura blanca",unit_cost:32.5,stock:45,stock_minimo:20},{id:5,cod:"MAT-005",name:"Clavos",unit_cost:.2,stock:1200,stock_minimo:500},{id:6,cod:"MAT-006",name:"Bisagras",unit_cost:2.75,stock:230,stock_minimo:100},{id:7,cod:"MAT-007",name:"Barniz",unit_cost:28.9,stock:18,stock_minimo:15},{id:8,cod:"MAT-008",name:"Lija",unit_cost:1.2,stock:340,stock_minimo:200},{id:9,cod:"MAT-009",name:"Tela tapiz",unit_cost:18.75,stock:65,stock_minimo:50},{id:10,cod:"MAT-010",name:"Espuma",unit_cost:12.3,stock:42,stock_minimo:30}],productos:[{id:1,cod:"PROD-001",name:"Silla clásica",unit_cost:150.5,stock:25,bom:[{cod:"MAT-001",qty:5},{cod:"MAT-002",qty:10}]},{id:2,cod:"PROD-002",name:"Mesa redonda",unit_cost:320.75,stock:8,bom:[{cod:"MAT-001",qty:8},{cod:"MAT-003",qty:4}]},{id:3,cod:"PROD-003",name:"Sofá de 3 plazas",unit_cost:850,stock:5,bom:[{cod:"MAT-001",qty:15},{cod:"MAT-009",qty:8},{cod:"MAT-010",qty:5}]},{id:4,cod:"PROD-004",name:"Estantería moderna",unit_cost:275.4,stock:12,bom:[{cod:"MAT-001",qty:10},{cod:"MAT-006",qty:12}]},{id:5,cod:"PROD-005",name:"Escritorio ejecutivo",unit_cost:420.9,stock:7,bom:[{cod:"MAT-001",qty:12},{cod:"MAT-002",qty:20},{cod:"MAT-006",qty:8}]}],buyers:[{id:1,name:"Juan Pérez",company:"Distribuciones Pérez SA",phone:"+51 987654321",email:"juan@perez.com",type:"mayorista",tax_id:"20123456789",address:"Av. Principal 123, La Paz",is_active:!0},{id:2,name:"María Gómez",company:"Tienda María",phone:"+51 987123456",email:"maria@gomez.com",type:"minorista",tax_id:"10456789234",address:"Calle Los Pinos 456, Sucre",is_active:!0},{id:3,name:"Carlos Rodríguez",company:"Importaciones CR",phone:"+51 987654987",email:"carlos@cr.com",type:"mayorista",tax_id:"20345678912",address:"Calle Comercio 789, Santa Cruz",is_active:!1},{id:4,name:"Ana Mendoza",company:"Muebles Mendoza",phone:"+51 987321654",email:"ana@mendoza.com",type:"mayorista",tax_id:"20198765432",address:"Av. Industrial 456, La Paz",is_active:!0},{id:5,name:"Luis Torres",company:"Decoraciones Torres",phone:"+51 987456123",email:"luis@torres.com",type:"minorista",tax_id:"10412345678",address:"Calle Mercaderes 789, Cochabamba",is_active:!0}],sales:[{id:1,buyer_id:1,date:"2025-05-20",items:[{cod:"PROD-001",qty:2,unit_price:150.5}],total:301,status:"completed"},{id:2,buyer_id:2,date:"2025-05-21",items:[{cod:"PROD-002",qty:1,unit_price:320.75},{cod:"PROD-001",qty:3,unit_price:150.5}],total:772.25,status:"completed"},{id:3,buyer_id:1,date:"2025-05-15",items:[{cod:"PROD-003",qty:1,unit_price:850},{cod:"PROD-005",qty:2,unit_price:420.9}],total:1691.8,status:"completed"},{id:4,buyer_id:3,date:"2025-05-18",items:[{cod:"PROD-004",qty:3,unit_price:275.4}],total:826.2,status:"pending"},{id:5,buyer_id:4,date:"2025-05-22",items:[{cod:"PROD-001",qty:5,unit_price:150.5},{cod:"PROD-002",qty:2,unit_price:320.75}],total:1397,status:"completed"}]};const r={getMateriales:()=>new Promise(t=>{setTimeout(()=>t([...a.materiales]),300)}),getMaterialById:t=>new Promise(e=>{setTimeout(()=>{const s=a.materiales.find(i=>i.id===t);e(s?{...s}:null)},300)}),addMaterial:t=>new Promise(e=>{setTimeout(()=>{const s=Math.max(...a.materiales.map(o=>o.id))+1,i={...t,id:s};a.materiales.push(i),e(i)},300)}),updateMaterial:(t,e)=>new Promise(s=>{setTimeout(()=>{const i=a.materiales.findIndex(o=>o.id===t);i!==-1?(a.materiales[i]={...a.materiales[i],...e},s(a.materiales[i])):s(null)},300)}),deleteMaterial:t=>new Promise(e=>{setTimeout(()=>{a.materiales=a.materiales.filter(s=>s.id!==t),e(!0)},300)}),getProductos:()=>new Promise(t=>{setTimeout(()=>t([...a.productos]),300)}),getProductoById:t=>new Promise(e=>{setTimeout(()=>{const s=a.productos.find(i=>i.id===t);e(s?{...s}:null)},300)}),addProducto:t=>new Promise(e=>{setTimeout(()=>{const s=Math.max(...a.productos.map(o=>o.id))+1,i={...t,id:s};a.productos.push(i),e(i)},300)}),updateProducto:(t,e)=>new Promise(s=>{setTimeout(()=>{const i=a.productos.findIndex(o=>o.id===t);i!==-1?(a.productos[i]={...a.productos[i],...e},s(a.productos[i])):s(null)},300)}),deleteProducto:t=>new Promise(e=>{setTimeout(()=>{a.productos=a.productos.filter(s=>s.id!==t),e(!0)},300)}),getBuyers:()=>new Promise(t=>{setTimeout(()=>t([...a.buyers]),300)}),getBuyerById:t=>new Promise(e=>{setTimeout(()=>{const s=a.buyers.find(i=>i.id===t);e(s?{...s}:null)},300)}),addBuyer:t=>new Promise(e=>{setTimeout(()=>{const s=Math.max(...a.buyers.map(o=>o.id))+1,i={...t,id:s};a.buyers.push(i),e(i)},300)}),updateBuyer:(t,e)=>new Promise(s=>{setTimeout(()=>{const i=a.buyers.findIndex(o=>o.id===t);i!==-1?(a.buyers[i]={...a.buyers[i],...e},s(a.buyers[i])):s(null)},300)}),deleteBuyer:t=>new Promise(e=>{setTimeout(()=>{a.buyers=a.buyers.filter(s=>s.id!==t),e(!0)},300)}),getSales:()=>new Promise(t=>{setTimeout(()=>t([...a.sales]),300)}),getSaleById:t=>new Promise(e=>{setTimeout(()=>{const s=a.sales.find(i=>i.id===t);e(s?{...s}:null)},300)}),addSale:t=>new Promise(e=>{setTimeout(()=>{const s=Math.max(...a.sales.map(o=>o.id),0)+1,i={...t,id:s};a.sales.push(i),e(i)},300)}),updateSale:(t,e)=>new Promise(s=>{setTimeout(()=>{const i=a.sales.findIndex(o=>o.id===t);i!==-1?(a.sales[i]={...a.sales[i],...e},s(a.sales[i])):s(null)},300)}),cancelSale:t=>new Promise(e=>{setTimeout(()=>{const s=a.sales.findIndex(i=>i.id===t);s!==-1?(a.sales[s].status="canceled",e(!0)):e(!1)},300)})},c=d("buyer",{state:()=>({buyers:[],loading:!1,error:null}),actions:{async fetchBuyers(){this.loading=!0,this.error=null;try{this.buyers=await r.getBuyers()}catch(t){throw this.error=t.message,t}finally{this.loading=!1}},async addBuyer(t){this.loading=!0;try{const e=await r.addBuyer(t);return this.buyers.push(e),e}catch(e){throw this.error=e.message,e}finally{this.loading=!1}},async updateBuyer(t,e){this.loading=!0;try{const s=await r.updateBuyer(t,e),i=this.buyers.findIndex(o=>o.id===t);return i!==-1&&(this.buyers[i]=s),s}catch(s){throw this.error=s.message,s}finally{this.loading=!1}},async deleteBuyer(t){this.loading=!0;try{await r.deleteBuyer(t),this.buyers=this.buyers.filter(e=>e.id!==t)}catch(e){throw this.error=e.message,e}finally{this.loading=!1}},async getSalesByBuyerReport(){const t=u();await t.fetchSales();const e={};return t.sales.forEach(s=>{e[s.buyer_id]||(e[s.buyer_id]={...this.getBuyerById(s.buyer_id),totalPurchases:0,totalSpent:0,invoiceCount:0}),s.status!=="canceled"&&(e[s.buyer_id].totalSpent+=s.total,e[s.buyer_id].invoiceCount++,e[s.buyer_id].totalPurchases+=s.items.reduce((i,o)=>i+o.qty,0))}),{buyers:Object.values(e),generatedAt:new Date().toISOString()}}},getters:{getBuyerById:t=>e=>t.buyers.find(s=>s.id===e),activeBuyers:t=>t.buyers.filter(e=>e.is_active),mayoristas:t=>t.buyers.filter(e=>e.type==="mayorista"),minoristas:t=>t.buyers.filter(e=>e.type==="minorista"),inactiveBuyers:t=>t.buyers.filter(e=>!e.is_active),totalBuyers:t=>t.buyers.length}}),u=d("sale",{state:()=>({sales:[],loading:!1,error:null}),actions:{async fetchSales(){this.loading=!0,this.error=null;try{this.sales=await r.getSales()}catch(t){throw this.error=t.message,t}finally{this.loading=!1}},async addSale(t){this.loading=!0;try{const e=await r.addSale(t);return this.sales.push(e),e}catch(e){throw this.error=e.message,e}finally{this.loading=!1}},async updateSale(t,e){this.loading=!0;try{const s=await r.updateSale(t,e),i=this.sales.findIndex(o=>o.id===t);return i!==-1&&(this.sales[i]=s),s}catch(s){throw this.error=s.message,s}finally{this.loading=!1}},async cancelSale(t){this.loading=!0;try{await r.cancelSale(t);const e=this.sales.findIndex(s=>s.id===t);e!==-1&&(this.sales[e].status="canceled")}catch(e){throw this.error=e.message,e}finally{this.loading=!1}},async generateInvoice(t){const e=this.getSaleById(t);if(!e)throw new Error("Venta no encontrada");const i=c().getBuyerById(e.buyer_id);if(!i)throw new Error("Comprador no encontrado");const o={name:"INPLAC SRL",address:"Calle Murillo #123, La Paz, Bolivia",phone:"+591 2 1234567",email:"info@inplac.bo",nit:"123456789",actividadEconomica:"Fabricación de muebles",leyenda:"Ley N° 453: Tienes derecho a recibir información sobre tus beneficios tributarios",numeroAutorizacion:"123456789",codigoControl:"ABC123XYZ",fechaLimiteEmision:"31/12/2025"};return{...e,buyer:i,companyInfo:o,invoiceNumber:`FAC-${String(t).padStart(6,"0")}`,fechaEmision:new Date().toLocaleDateString("es-BO"),codigoQR:`https://api.qrserver.com/v1/create-qr-code/?size=150x150&data=${encodeURIComponent(`NIT:${o.nit}|NRO:${t}|AUT:${o.numeroAutorizacion}|FEC:${new Date().toISOString().slice(0,10)}|TOT:${e.total}|COD:${o.codigoControl}`)}`}},async getInvoicesReport(t,e){this.loading=!0;try{const s=this.sales.filter(o=>{const n=new Date(o.date);return n>=new Date(t)&&n<=new Date(e)}),i={totalAmount:s.reduce((o,n)=>o+n.total,0),totalInvoices:s.length,totalCanceled:s.filter(o=>o.status==="canceled").length};return{invoices:s,summary:i,generatedAt:new Date().toISOString()}}catch(s){throw this.error=s.message,s}finally{this.loading=!1}}},getters:{getSaleById:t=>e=>(console.log(t),console.log(e),t.sales.find(s=>s.id===e)),completedSales:t=>t.sales.filter(e=>e.status==="completed"),pendingSales:t=>t.sales.filter(e=>e.status==="pending"),canceledSales:t=>t.sales.filter(e=>e.status==="canceled"),salesByBuyer:t=>e=>t.sales.filter(s=>s.buyer_id===e)}});export{u as a,r as b,c as u};
